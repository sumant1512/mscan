<div class="form-container">
  <div class="header">
    <h2>{{ isEditMode ? 'Edit Category' : 'Create New Category' }}</h2>
  </div>

  <div *ngIf="error" class="alert alert-error">{{ error }}</div>
  <div *ngIf="success" class="alert alert-success">{{ success }}</div>

  <form [formGroup]="categoryForm" (ngSubmit)="onSubmit()" class="category-form">
    <div class="form-grid">
      <div class="form-group full-width">
        <label for="name">Category Name <span class="required">*</span></label>
        <input
          type="text"
          id="name"
          formControlName="name"
          [class.invalid]="isFieldInvalid('name')"
          placeholder="e.g., Electronics, Clothing, Food"
        />
        <span *ngIf="isFieldInvalid('name')" class="error-text">
          {{ getFieldError('name') }}
        </span>
      </div>

      <div class="form-group full-width">
        <label for="description">Description</label>
        <textarea
          id="description"
          formControlName="description"
          rows="3"
          placeholder="Optional description of this category"
        ></textarea>
      </div>

      <div class="form-group">
        <label for="icon">Icon</label>
        <select id="icon" formControlName="icon">
          <option *ngFor="let icon of materialIcons" [value]="icon">
            {{ icon }}
          </option>
        </select>
        <small class="hint">Material icon name</small>
      </div>

      <div class="form-group">
        <label class="checkbox-label">
          <input type="checkbox" formControlName="is_active" />
          <span>Active</span>
        </label>
        <small class="hint">Only active categories can be used</small>
      </div>

      <div class="icon-preview full-width">
        <label>Icon Preview</label>
        <div class="preview-box">
          <span class="material-icons">{{ categoryForm.get('icon')?.value }}</span>
          <span class="preview-text">{{ categoryForm.get('name')?.value || 'Category Name' }}</span>
        </div>
      </div>
    </div>

    <div class="form-actions">
      <button type="button" (click)="cancel()" class="btn-secondary" [disabled]="loading">
        Cancel
      </button>
      <button type="submit" class="btn-primary" [disabled]="loading || categoryForm.invalid">
        <span *ngIf="loading">Saving...</span>
        <span *ngIf="!loading">{{ isEditMode ? 'Update Category' : 'Create Category' }}</span>
      </button>
    </div>
  </form>
</div>
