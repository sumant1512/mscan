<div class="verification-app-container">
  <div class="header">
    <h1>Verification Apps</h1>
    <button *ngIf="canCreateApp" class="btn-primary" (click)="configureApp()">
      <span class="material-icons">add</span>
      Create New App
    </button>
  </div>

  <div *ngIf="verificationAppsFacade.loading$ | async" class="loading">Loading...</div>
  <div *ngIf="verificationAppsFacade.error$ | async as error" class="error">{{ error }}</div>

  <div *ngIf="!(verificationAppsFacade.loading$ | async) && !(verificationAppsFacade.error$ | async) && apps.length === 0" class="empty-state">
    <span class="material-icons">verified</span>
    <h3>No Verification Apps Yet</h3>
    <p *ngIf="canCreateApp">Create your first verification app to start generating QR codes for your coupons.</p>
    <p *ngIf="!canCreateApp">Contact your administrator to create verification apps.</p>
    <button *ngIf="canCreateApp" class="btn-primary" (click)="configureApp()">
      <span class="material-icons">add</span>
      Create Verification App
    </button>
  </div>

  <div *ngIf="!(verificationAppsFacade.loading$ | async) && !(verificationAppsFacade.error$ | async) && apps.length > 0" class="apps-grid">
    <div *ngFor="let app of apps" class="app-card">
      <div class="app-header">
        <img [src]="app.logo_url || '/assets/default-logo.png'" alt="App Logo" class="app-logo">
        <h3>{{ app.app_name }}</h3>
      </div>
      <p class="app-description">{{ app.description || 'No description' }}</p>
      <div class="app-stats">
        <div class="stat">
          <span class="material-icons">qr_code</span>
          <div>
            <strong>{{ app.total_coupons || 0 }}</strong>
            <span>Coupons</span>
          </div>
        </div>
        <div class="stat">
          <span class="material-icons">qr_code_scanner</span>
          <div>
            <strong>{{ app.total_scans || 0 }}</strong>
            <span>Scans</span>
          </div>
        </div>
      </div>
      <div class="app-actions">
        <button *ngIf="canEditApp" class="btn-secondary" (click)="editApp(app.verification_app_id)">
          <span class="material-icons">edit</span>
          Configure
        </button>
        <button *ngIf="canEditApp" class="btn-secondary" (click)="configureApi(app.verification_app_id)">
          <span class="material-icons">api</span>
          API Config
        </button>
        <span *ngIf="!canEditApp" class="read-only-badge">Read-Only</span>
      </div>
    </div>
  </div>
</div>